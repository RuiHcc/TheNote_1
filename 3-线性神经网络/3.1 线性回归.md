回归（regression）是能为一个或多个自变量与因变量之间关系建模的一类方法。  
在机器学习领域中的大多数任务通常都与预测（prediction）有关。 当我们想预测一个 数值 时，就会涉及到回归问题。

### 线性模型  
线性回归基于几个简单的假设： 首先，假设自变量x(向量)和因变量y(数值)之间的关系是线性的， 即y可以表示为x中元素的加权和，这里通常允许包含观测值的一些噪声；我们假设任何噪声都比较正常，如噪声b遵循正态分布。  
$$
y = w1x1 + w2x2 + b  
$$
其中w称为权重，决定每个特征对我们预测值的影响。b称为偏置、偏移量或者截距。给定一个数据集，我们的目标是寻找模型的权重w和偏置b，使得模型能够尽可能的预测真实的数值。  
在开始寻找最好的模型参数（model parameters）𝑤和𝑏之前， 我们还需要两个东西： 
	（1）一种模型质量的度量方式； 
	（2）一种能够更新模型以提高模型预测质量的方法。

### 损失函数
在我们开始考虑如何用模型 _拟合_（fit）数据之前，我们需要确定一个拟合程度的度量。
一般采用平方误差：
$$
l^{(i)}(w,b) = 1/2(y^{'{(i)}} - y^{(i)})
$$
常数1/2不会带来本质的差别，但这样在形式上稍微简单一些（因为当我们对损失函数求导后常数系数为1）。
为了度量模型在整个数据集上的质量，我们需计算在训练集𝑛个样本上的损失均值
![[Pasted image 20250226110924.png | 600]]
我们最终要找的参数$(w^{*},b^{*})$ ，这组参数能够最小化训练样本上的总损失： 
![[Pasted image 20250226111123.png | 350]]
### 解析解
由于线性回归问题是一个较为简单的优化问题，能够从数学公式表达出来， 这类解叫作解析解。首先，我们将偏置𝑏合并到参数𝑤中，合并方法是在包含所有参数的矩阵中附加一列。 我们的预测问题是最小化$||y-Xw||^{2}$ 。这在损失平面上只有一个临界点，这个临界点对应于整个区域的损失极小点。 将损失关于𝑤的导数设为0，得到解析解：
$$
w^{*} = (X^{T}X)^{-1}X^{T}y
$$
实际上，常规需要用深度学习来解决的问题是不存在解析解的。

### 随机梯度下降
即使在我们无法得到解析解的情况下，我们仍然可以有效地训练模型。
本书中我们用到一种名为 _梯度下降_（gradient descent）的方法， 这种方法几乎可以优化所有深度学习模型。 它通过**不断地在损失函数递减的方向上更新参数**来降低误差。梯度下降最简单的用法是计算损失函数（数据集中所有样本的损失均值） 关于模型参数的导数（在这里也可以称为梯度）。

但在实际使用中，我们不可能每更新一次参数，就去遍历整个数据集；因为数据集是非常庞大的，这会导致执行过于缓慢。通常会在每次需要计算更新的时候随机抽取一小批样本， 这种变体叫做 _小批量随机梯度下降_ ：
	在每次迭代中，我们首先随机抽样一个小批量𝐵， 它是由固定数量的训练样本组成的。然后，我们计算小批量的平均损失关于模型参数的导数（也可以称为梯度）。 最后，我们将梯度乘以一个预先确定的正数𝜂，并从当前参数的值中减掉。
我们用下面的数学公式来表示这一更新过程（𝜕表示偏导数）： |𝐵|表示每个小批量中的样本数，这也称为 _批量大小_（batch size）。 𝜂表示 _学习率_（learning rate）。
![[Pasted image 20250226112411.png | 400]]
批量大小和学习率的值通常是手动预先指定，而不是通过模型训练得到的。 这些可以调整但不在训练过程中更新的参数称为_超参数_（hyperparameter）。 **_调参_** 是选择超参数的过程。超参数通常是我们根据训练迭代结果来调整的， 而训练迭代结果是在独立的 _验证数据集_ 上评估得到的。
>总结一下，算法的步骤如下： 
>	（1）初始化模型参数的值，如随机初始化； 
>	（2）从数据集中随机抽取小批量样本且在负梯度的方向上更新参数，并不断迭代这一步骤。

线性回归恰好是一个在整个域中只有一个最小值的学习问题。 但是对像深度神经网络这样复杂的模型来说，损失平面上通常包含多个最小值。 深度学习实践者很少会去花费大力气寻找这样一组参数，使得在_训练集_上的损失达到最小。 事实上，更难做到的是找到一组参数，这组参数能够在我们从未见过的数据上实现较低的损失， 这一挑战被称为_泛化_（generalization）。